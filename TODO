* check whether to add _servicedata. sometimes it didn't exist before.
* split functions
